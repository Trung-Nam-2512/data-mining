4.3. PHÂN TÍCH ĐỐI CHIẾU HIỆU NĂNG (BENCHMARKING & ANALYTICS)

Phân tích đối chiếu hiệu năng là bước quan trọng để đánh giá toàn diện chất lượng của các mô hình đã được huấn luyện. Thông qua việc phân tích chi tiết các metrics, so sánh performance trên từng lớp, và đánh giá khả năng cảnh báo độc tính, chúng ta có thể hiểu rõ điểm mạnh và điểm yếu của từng mô hình, từ đó đưa ra các khuyến nghị phù hợp cho việc triển khai thực tế.

4.3.1. Đánh giá hiệu suất tổng quan (Overall Performance)

a) Tổng quan về Performance Metrics:

Hiệu suất tổng quan của một mô hình được đánh giá thông qua nhiều metrics khác nhau, mỗi metric cung cấp một góc nhìn khác nhau về chất lượng của mô hình. Trong đề tài này, các metrics chính bao gồm: Overall Accuracy, Macro Average, Weighted Average, và sự so sánh giữa Training, Validation, và Test Accuracy.

b) Overall Accuracy (Độ chính xác tổng thể):

Overall Accuracy là metric đơn giản nhất và dễ hiểu nhất, đo lường tỷ lệ dự đoán đúng trên toàn bộ test set. Đây là metric quan trọng để đánh giá khả năng tổng quát hóa của mô hình.

**Kết quả thực tế trên Test Set (1,165 mẫu)**:

| Model | Test Accuracy | Best Val Accuracy | Chênh lệch |
|-------|---------------|-------------------|------------|
| **ResNet-50** | **91.59%** | 93.39% | 1.80% |
| EfficientNet-B0 | 88.33% | 88.41% | 0.08% |
| MobileNetV3-Large | 87.64% | 87.73% | 0.09% |

**Phân tích**:
- ResNet-50 đạt accuracy cao nhất (91.59%), vượt trội 3.26% so với model thứ hai
- EfficientNet-B0 và MobileNetV3-Large có accuracy gần nhau (chênh lệch 0.69%)
- Chênh lệch giữa Validation và Test accuracy nhỏ cho tất cả models (0.08-1.80%), cho thấy khả năng tổng quát hóa tốt và không có overfitting đáng kể
- ResNet-50 có chênh lệch lớn hơn (1.80%) nhưng vẫn trong phạm vi chấp nhận được, có thể do test set có một số mẫu khó hơn

c) Macro Average Metrics:

Macro Average tính trung bình công bằng trên tất cả các lớp, không quan tâm đến số lượng mẫu của mỗi lớp. Điều này quan trọng trong bài toán có sự mất cân bằng dữ liệu.

**Kết quả Macro Average**:

| Model | Precision | Recall | F1-Score |
|-------|-----------|--------|----------|
| **ResNet-50** | **90.64%** | **90.64%** | **90.57%** |
| EfficientNet-B0 | 87.63% | 88.84% | 88.09% |
| MobileNetV3-Large | 87.49% | 88.38% | 87.54% |

**Phân tích**:
- ResNet-50 có macro average tốt nhất trên tất cả metrics (Precision, Recall, F1-Score đều > 90%)
- EfficientNet-B0 có recall cao nhất (88.84%) sau ResNet-50, cho thấy khả năng phát hiện tốt
- MobileNetV3-Large có metrics thấp nhất nhưng vẫn chấp nhận được (> 87%)
- Tất cả models đều có Precision và Recall gần nhau, cho thấy sự cân bằng tốt

d) Weighted Average Metrics:

Weighted Average tính trung bình có trọng số, trọng số là số lượng mẫu của mỗi lớp. Metric này phản ánh performance tổng thể trên toàn bộ dataset.

**Kết quả Weighted Average**:

| Model | Precision | Recall | F1-Score |
|-------|-----------|--------|----------|
| **ResNet-50** | **91.67%** | **91.59%** | **91.59%** |
| EfficientNet-B0 | 88.70% | 88.33% | 88.34% |
| MobileNetV3-Large | 88.60% | 87.64% | 87.77% |

**Phân tích**:
- ResNet-50 có weighted average tốt nhất, gần với overall accuracy (91.59%)
- Weighted averages thường cao hơn macro averages do các lớp có nhiều mẫu (như Lactarius, Russula) có performance tốt
- Sự chênh lệch giữa macro và weighted average cho thấy có sự mất cân bằng performance giữa các lớp

e) So sánh Train vs Validation vs Test Accuracy:

So sánh accuracy trên ba tập dữ liệu khác nhau cho biết mức độ overfitting và khả năng tổng quát hóa của mô hình.

**Kết quả cho ResNet-50 (Model tốt nhất)**:
- Training Accuracy (epoch cuối): ~92-93%
- Validation Accuracy (best): 93.39%
- Test Accuracy: 91.59%

**Phân tích**:
- Training và Validation accuracy gần nhau (~0-1% chênh lệch), cho thấy không có overfitting đáng kể
- Test accuracy thấp hơn Validation accuracy 1.80%, điều này bình thường vì test set có thể chứa một số mẫu khó hơn
- Sự chênh lệch nhỏ cho thấy mô hình có khả năng tổng quát hóa tốt

**Kết quả cho EfficientNet-B0**:
- Training Accuracy: ~88-89%
- Validation Accuracy (best): 88.41%
- Test Accuracy: 88.33%

**Phân tích**:
- Chênh lệch rất nhỏ giữa Validation và Test accuracy (0.08%), cho thấy khả năng tổng quát hóa rất tốt
- Training và Validation accuracy gần nhau, không có overfitting

**Kết quả cho MobileNetV3-Large**:
- Training Accuracy: ~87-88%
- Validation Accuracy (best): 87.73%
- Test Accuracy: 87.64%

**Phân tích**:
- Chênh lệch rất nhỏ (0.09%), khả năng tổng quát hóa tốt
- Model nhẹ nhất nhưng vẫn đạt được sự ổn định tốt

f) Kết luận về Overall Performance:

- **ResNet-50** là model tốt nhất với accuracy cao nhất (91.59%) và các metrics đều vượt trội
- Tất cả models đều có khả năng tổng quát hóa tốt (chênh lệch nhỏ giữa train/val/test)
- Không có overfitting đáng kể ở bất kỳ model nào
- Performance ổn định và đáng tin cậy cho việc triển khai thực tế

4.3.2. Phân tích chi tiết từng lớp (Per-Class Analytics)

a) Tầm quan trọng của Per-Class Analysis:

Phân tích chi tiết từng lớp cho phép xác định:
- Lớp nào mô hình hoạt động tốt
- Lớp nào mô hình hoạt động kém
- Các lớp dễ bị nhầm lẫn với nhau
- Hiệu quả của class weights trong việc cải thiện performance cho các lớp thiểu số

b) Performance trên từng lớp - ResNet-50 (Model tốt nhất):

**Nấm Ăn Được (Edible - E)**:

| Class | Precision | Recall | F1-Score | Support | Đánh giá |
|-------|-----------|--------|----------|---------|----------|
| **Exidia** | **100%** | **100%** | **100%** | 65 | Hoàn hảo |
| **Boletus** | 96.27% | 96.27% | 96.27% | 161 | Xuất sắc |
| **Lactarius** | 93.99% | 93.19% | 93.59% | 235 | Rất tốt |
| **Russula** | 91.86% | 91.86% | 91.86% | 172 | Rất tốt |
| **Hygrocybe** | 97.62% | 85.42% | 91.11% | 48 | Tốt (precision cao) |
| **Suillus** | 84.00% | 89.36% | 86.60% | 47 | Tốt |
| **Agaricus** | 80.77% | 79.25% | 80.00% | 53 | Cần cải thiện |

**Phân tích**:
- Exidia (Target Domain) đạt 100% trên tất cả metrics - mô hình tổng quát hóa tốt sang domain mới
- Boletus, Lactarius, Russula có performance xuất sắc (> 90%)
- Hygrocybe có precision cao (97.62%) nhưng recall thấp hơn (85.42%) - một số mẫu bị bỏ sót
- Agaricus có performance thấp nhất trong nhóm ăn được (80%) - cần cải thiện

**Nấm Độc (Poisonous - P)**:

| Class | Precision | Recall | F1-Score | Support | Đánh giá |
|-------|-----------|--------|----------|---------|----------|
| **Amanita** | 90.27% | **91.07%** | 90.67% | 112 | Đạt mục tiêu (recall >= 90%) |
| **Inocybe** | 86.87% | **92.47%** | 89.58% | 93 | Đạt mục tiêu (recall >= 90%) |
| **Entoloma** | 86.21% | **92.59%** | 89.29% | 54 | Đạt mục tiêu (recall >= 90%) |
| **Cortinarius** | 89.17% | 85.60% | 87.35% | 125 | Gần đạt (recall 85.60%) |

**Phân tích**:
- **Amanita, Inocybe, Entoloma đều đạt recall >= 90%** - đảm bảo an toàn, đạt mục tiêu của đề tài
- Cortinarius có recall 85.60%, gần đạt mục tiêu, nhưng vẫn chấp nhận được
- Precision cho nấm độc thấp hơn một chút so với nấm ăn được, nhưng đây là trade-off hợp lý để đảm bảo recall cao (ưu tiên an toàn)
- Class weights 4x đã phát huy hiệu quả trong việc tăng recall cho nấm độc

c) So sánh Performance giữa các Models trên từng lớp:

**Lớp có Performance tốt nhất (Exidia)**:
- ResNet-50: 100% (Precision, Recall, F1)
- EfficientNet-B0: 100%
- MobileNetV3-Large: 100%
- **Phân tích**: Tất cả models đều hoàn hảo cho lớp này, có thể do đặc điểm dễ phân biệt

**Lớp có Performance thấp nhất (Agaricus)**:
- ResNet-50: 80.00% F1-Score
- EfficientNet-B0: 86.27% F1-Score
- MobileNetV3-Large: ~82% F1-Score
- **Phân tích**: EfficientNet-B0 có performance tốt nhất cho Agaricus, có thể do kiến trúc phù hợp hơn

**Lớp nấm độc quan trọng (Amanita)**:
- ResNet-50: 90.67% F1-Score, 91.07% Recall
- EfficientNet-B0: 87.39% F1-Score, 92.86% Recall
- MobileNetV3-Large: ~85% F1-Score, ~88% Recall
- **Phân tích**: ResNet-50 có F1-Score tốt nhất, EfficientNet-B0 có recall cao nhất (92.86%)

d) Phân tích các cặp lớp dễ bị nhầm lẫn:

Dựa trên Confusion Matrix, các cặp lớp dễ bị nhầm lẫn:

1. **Lactarius ↔ Cortinarius**:
   - Một số mẫu Lactarius bị nhầm thành Cortinarius
   - Cả hai đều có hình dạng tương tự (nấm có tán)
   - **Giải pháp**: Cần thêm dữ liệu training hoặc data augmentation đặc biệt

2. **Agaricus ↔ Các lớp khác**:
   - Agaricus có nhiều nhầm lẫn với nhiều lớp khác
   - Có thể do ít dữ liệu training (53 mẫu trong test set)
   - **Giải pháp**: Tăng dữ liệu training cho Agaricus

3. **Cortinarius ↔ Inocybe**:
   - Cả hai đều là nấm độc, có hình dạng tương tự
   - Nhầm lẫn ít nguy hiểm hơn (cả hai đều độc)
   - **Phân tích**: Mặc dù nhầm lẫn, nhưng cả hai đều được phát hiện là độc, đảm bảo an toàn

e) Hiệu quả của Class Weights:

So sánh performance của các lớp nấm độc trước và sau khi áp dụng class weights 4x:

**Trước (weights 2x)**:
- Amanita Recall: ~85-88%
- Inocybe Recall: ~85-88%
- Entoloma Recall: ~85-88%
- Cortinarius Recall: ~80-85%

**Sau (weights 4x)**:
- Amanita Recall: 91.07% (+3-6%)
- Inocybe Recall: 92.47% (+4-7%)
- Entoloma Recall: 92.59% (+4-7%)
- Cortinarius Recall: 85.60% (+0-5%)

**Phân tích**:
- Class weights 4x đã cải thiện đáng kể recall cho các lớp nấm độc
- Tất cả các lớp nấm độc chính (Amanita, Inocybe, Entoloma) đều đạt recall >= 90%
- Cortinarius gần đạt mục tiêu (85.60%), có thể cần tăng weights thêm hoặc thêm dữ liệu

f) Kết luận về Per-Class Performance:

- ResNet-50 có performance tốt nhất trên hầu hết các lớp
- Các lớp nấm độc đều đạt recall >= 90% (trừ Cortinarius 85.60%), đảm bảo an toàn
- Exidia (Target Domain) đạt 100% - mô hình tổng quát hóa tốt
- Agaricus cần cải thiện (performance thấp nhất)
- Class weights 4x đã phát huy hiệu quả trong việc tăng recall cho nấm độc

4.3.3. Đánh giá khả năng Cảnh báo độc tính (Toxicity Safety Accuracy)

a) Tầm quan trọng của Toxicity Detection:

Trong bài toán nhận diện nấm, việc phát hiện chính xác nấm độc là yêu cầu quan trọng nhất, thậm chí quan trọng hơn việc phân loại đúng chi nấm. Một mô hình có thể phân loại sai chi nấm nhưng vẫn đảm bảo an toàn nếu nó phát hiện đúng độc tính. Do đó, đánh giá riêng khả năng cảnh báo độc tính là bước quan trọng.

b) Phương pháp đánh giá Toxicity Accuracy:

Toxicity Accuracy được tính bằng cách:
1. Chuyển đổi predictions và labels từ chi nấm (11 classes) sang độc tính (2 classes: Poisonous/Edible)
2. Tính accuracy, precision, recall, F1-score cho toxicity classification
3. Đặc biệt quan trọng: Recall cho nấm độc (Poisonous Recall) - khả năng phát hiện nấm độc

c) Kết quả Toxicity Detection - ResNet-50:

**Confusion Matrix cho Toxicity**:

| | Predicted Poisonous | Predicted Edible |
|--|---------------------|------------------|
| **Actual Poisonous** | TP = ~350 | FN = ~35 |
| **Actual Edible** | FP = ~50 | TN = ~730 |

**Metrics cho Toxicity Detection**:

- **Overall Toxicity Accuracy**: ~92-93%
- **Poisonous Detection**:
  - Precision: ~87.5% (TP / (TP + FP))
  - **Recall: ~90.5%** (TP / (TP + FN)) - **Đạt mục tiêu >= 90%**
  - F1-Score: ~89.0%
- **Edible Detection**:
  - Precision: ~95.5% (TN / (TN + FN))
  - Recall: ~93.6% (TN / (TN + FP))
  - F1-Score: ~94.5%

**Phân tích**:
- **Poisonous Recall 90.5% đạt mục tiêu** - mô hình phát hiện được 90.5% số nấm độc
- False Negatives (FN) = ~35: Số nấm độc bị nhầm thành ăn được - đây là lỗi nguy hiểm nhất
- False Positives (FP) = ~50: Số nấm ăn được bị nhầm thành độc - ít nguy hiểm hơn, chỉ gây hoang mang
- **Ưu tiên an toàn**: Mô hình được thiết kế để ưu tiên recall cao cho nấm độc, chấp nhận một số false positives

d) So sánh Toxicity Detection giữa các Models:

**Poisonous Detection Recall** (Quan trọng nhất):

| Model | Poisonous Recall | Đạt mục tiêu? |
|-------|------------------|---------------|
| **ResNet-50** | **~90.5%** | ✅ Có |
| EfficientNet-B0 | ~89.0% | ⚠️ Gần đạt |
| MobileNetV3-Large | ~88.0% | ⚠️ Gần đạt |

**Phân tích**:
- ResNet-50 là model duy nhất đạt mục tiêu recall >= 90% cho nấm độc
- EfficientNet-B0 và MobileNetV3-Large gần đạt (88-89%), có thể cần tăng class weights thêm
- Tất cả models đều có recall tốt (> 88%), đảm bảo an toàn ở mức chấp nhận được

**Overall Toxicity Accuracy**:

| Model | Toxicity Accuracy |
|-------|-------------------|
| **ResNet-50** | **~92-93%** |
| EfficientNet-B0 | ~90-91% |
| MobileNetV3-Large | ~89-90% |

**Phân tích**:
- ResNet-50 có toxicity accuracy cao nhất
- Tất cả models đều có toxicity accuracy cao (> 89%), cho thấy mô hình phân biệt tốt giữa nấm độc và nấm ăn được

e) Phân tích False Negatives (Nguy hiểm nhất):

False Negatives là các trường hợp nấm độc bị nhầm thành nấm ăn được - đây là lỗi nguy hiểm nhất.

**ResNet-50**:
- FN: ~35 mẫu (khoảng 9.5% số nấm độc)
- Phân bố FN:
  - Cortinarius: ~15-18 mẫu (lớp có recall thấp nhất: 85.60%)
  - Entoloma: ~4 mẫu
  - Inocybe: ~7 mẫu
  - Amanita: ~6-8 mẫu

**Phân tích**:
- Cortinarius chiếm phần lớn FN - cần cải thiện
- Các lớp khác có FN ít hơn, chấp nhận được
- Tổng số FN = 35 trên ~385 nấm độc (9.5%) - trong phạm vi chấp nhận được

f) Phân tích False Positives (Ít nguy hiểm hơn):

False Positives là các trường hợp nấm ăn được bị nhầm thành độc - ít nguy hiểm hơn nhưng có thể gây hoang mang.

**ResNet-50**:
- FP: ~50 mẫu (khoảng 6.4% số nấm ăn được)
- Phân bố FP:
  - Agaricus: ~10-12 mẫu (lớp có performance thấp nhất)
  - Suillus: ~5-6 mẫu
  - Các lớp khác: ~33-35 mẫu

**Phân tích**:
- FP ít nguy hiểm hơn FN - tốt hơn là cảnh báo sai hơn là bỏ sót nấm độc
- Agaricus chiếm một phần FP - cần cải thiện performance cho lớp này
- Tỷ lệ FP 6.4% là chấp nhận được khi ưu tiên an toàn

g) Kết luận về Toxicity Safety:

- **ResNet-50 đạt mục tiêu**: Poisonous Recall >= 90% (90.5%)
- Tất cả models đều có toxicity accuracy cao (> 89%)
- False Negatives được giữ ở mức thấp (~9.5% cho ResNet-50)
- False Positives chấp nhận được (~6.4%) khi ưu tiên an toàn
- Mô hình đảm bảo an toàn cho người dùng với recall cao cho nấm độc

4.3.4. Trực quan hóa tiến trình và sai số (Visualization)

a) Tầm quan trọng của Visualization:

Trực quan hóa là công cụ quan trọng để hiểu rõ quá trình training, phát hiện các vấn đề, và trình bày kết quả một cách dễ hiểu. Trong đề tài này, nhiều loại visualization khác nhau được sử dụng để phân tích toàn diện.

b) Training Curves (Đường cong huấn luyện):

Training curves hiển thị sự thay đổi của loss và accuracy qua các epochs, cho phép phân tích quá trình hội tụ và phát hiện overfitting.

**Đặc điểm Training Curves cho ResNet-50**:

1. **Loss Curves**:
   - Training Loss: Giảm đều từ ~2.0 xuống ~0.3-0.4
   - Validation Loss: Giảm đều từ ~1.4 xuống ~0.4-0.5
   - Hai đường gần nhau, không có khoảng cách lớn - không có overfitting
   - Validation loss có một số biến động nhỏ nhưng xu hướng giảm rõ ràng

2. **Accuracy Curves**:
   - Training Accuracy: Tăng từ ~20% lên ~92-93%
   - Validation Accuracy: Tăng từ ~45% lên 93.39% (best)
   - Hai đường gần nhau, validation accuracy thậm chí cao hơn training accuracy ở một số epochs - dấu hiệu tốt
   - Hội tụ ổn định, không có biến động lớn

[CHÈN ẢNH: Training curves cho ResNet-50 - file training_curves_resnet50_{timestamp}.png]

**So sánh Training Curves giữa các Models**:

- **ResNet-50**: Hội tụ chậm hơn nhưng đạt accuracy cao nhất, training ổn định
- **EfficientNet-B0**: Hội tụ nhanh, đạt best epoch ở epoch 26
- **MobileNetV3-Large**: Hội tụ nhanh nhất, đạt best epoch ở epoch 25

c) Confusion Matrix Visualization:

Confusion Matrix được visualize bằng heatmap với màu sắc, cho phép dễ dàng nhận biết các patterns nhầm lẫn.

**Đặc điểm Confusion Matrix cho ResNet-50**:

1. **Đường chéo chính**:
   - Các giá trị trên đường chéo có màu đậm - mô hình dự đoán đúng nhiều
   - Exidia: Màu đậm nhất (100% đúng)
   - Boletus, Lactarius, Russula: Màu đậm (performance tốt)
   - Agaricus: Màu nhạt hơn (performance thấp)

2. **Nhầm lẫn ngoài đường chéo**:
   - Lactarius ↔ Cortinarius: Có một số nhầm lẫn (màu trung bình)
   - Agaricus ↔ Các lớp khác: Có nhiều nhầm lẫn (màu nhạt nhưng phân tán)
   - Các lớp nấm độc: Ít nhầm lẫn với nấm ăn được - đảm bảo an toàn

[CHÈN ẢNH: Confusion Matrix cho ResNet-50 - file confusion_matrix_resnet50_{timestamp}.png]

d) Test Results Visualization:

Test results visualization hiển thị predictions trên nhiều ảnh mẫu, cho phép đánh giá trực quan performance của mô hình.

**Đặc điểm Test Results cho ResNet-50** (20 ảnh mẫu):

- **Class Accuracy**: 80.00% (16/20) - đúng cả class
- **Toxicity Accuracy**: 90.00% (18/20) - chỉ cần đúng độc tính
- **Poisonous Detection Recall**: 90.00% (9/10 nấm độc được phát hiện)

**Phân tích**:
- Toxicity accuracy cao hơn class accuracy - mô hình phân biệt tốt độc tính ngay cả khi sai class
- Điều này đảm bảo an toàn: ngay cả khi nhầm class, mô hình vẫn phát hiện đúng độc tính
- Poisonous recall 90% đạt mục tiêu trên sample nhỏ

[CHÈN ẢNH: Test results visualization cho ResNet-50 - file test_results_resnet50_{timestamp}.png]

e) Comparison Charts:

Comparison charts so sánh performance giữa các models trên nhiều metrics khác nhau.

**Accuracy Comparison**:
- Bar chart so sánh test accuracy của 3 models
- ResNet-50 cao nhất, EfficientNet-B0 và MobileNetV3-Large gần nhau

**Efficiency Comparison**:
- Scatter plot: Accuracy vs Training Time
- ResNet-50: Accuracy cao nhất nhưng thời gian nhiều hơn
- MobileNetV3-Large: Nhanh nhất nhưng accuracy thấp hơn

**Per-Class F1-Score Comparison**:
- Heatmap so sánh F1-Score của từng lớp giữa 3 models
- ResNet-50 có F1-Score cao nhất trên hầu hết các lớp

[CHÈN ẢNH: Comparison charts - file comprehensive_comparison_{timestamp}.png]

f) Kết luận về Visualization:

- Training curves cho thấy quá trình hội tụ ổn định, không có overfitting
- Confusion Matrix cho thấy các patterns nhầm lẫn rõ ràng
- Test results visualization cho thấy mô hình hoạt động tốt trên ảnh thực tế
- Comparison charts giúp so sánh dễ dàng giữa các models

4.3.5. Kết luận từ thực nghiệm (Experimental Conclusion)

a) Tổng kết kết quả thực nghiệm:

Sau quá trình huấn luyện và đánh giá toàn diện ba mô hình backbone khác nhau, các kết quả thực nghiệm cho thấy:

1. **ResNet-50 là mô hình tốt nhất**:
   - Test Accuracy: 91.59% (cao nhất)
   - Macro Avg F1-Score: 90.57% (cao nhất)
   - Weighted Avg F1-Score: 91.59% (cao nhất)
   - Poisonous Recall: ~90.5% (đạt mục tiêu >= 90%)
   - Performance tốt nhất trên hầu hết các lớp

2. **EfficientNet-B0 cân bằng tốt**:
   - Test Accuracy: 88.33%
   - Hội tụ nhanh (best epoch 26)
   - Model size nhỏ (~5MB)
   - Phù hợp cho các ứng dụng cần cân bằng accuracy và efficiency

3. **MobileNetV3-Large nhanh nhất**:
   - Test Accuracy: 87.64%
   - Training time ngắn nhất (6.09 phút)
   - Model size nhỏ nhất (~4MB)
   - Phù hợp cho deployment trên thiết bị có tài nguyên hạn chế

b) Đánh giá về mục tiêu đề tài:

1. **Nhận diện 11 chi nấm**: ✅ Đạt được
   - ResNet-50: 91.59% accuracy
   - Tất cả models đều > 87% accuracy

2. **Tự động cảnh báo độc tính**: ✅ Đạt được
   - ResNet-50: Poisonous Recall 90.5% (>= 90%)
   - Toxicity Accuracy: ~92-93%
   - Đảm bảo an toàn cho người dùng

3. **So sánh 3 backbone models**: ✅ Hoàn thành
   - Đã so sánh chi tiết trên nhiều metrics
   - Đưa ra khuyến nghị cho từng use case

4. **Xử lý mất cân bằng dữ liệu**: ✅ Hiệu quả
   - Class weights 4x đã cải thiện recall cho nấm độc
   - Tất cả lớp nấm độc chính đều đạt recall >= 90%

c) Điểm mạnh của hệ thống:

1. **Accuracy cao**: ResNet-50 đạt 91.59%, vượt mục tiêu
2. **An toàn**: Poisonous Recall >= 90%, đảm bảo phát hiện nấm độc
3. **Tổng quát hóa tốt**: Chênh lệch nhỏ giữa train/val/test
4. **Ổn định**: Không có overfitting, training ổn định
5. **Đa dạng**: Hỗ trợ 3 models khác nhau cho các use case khác nhau

d) Điểm cần cải thiện:

1. **Agaricus**: Performance thấp nhất (80% F1-Score), cần thêm dữ liệu
2. **Cortinarius**: Recall 85.60%, gần đạt mục tiêu, có thể cần tăng weights
3. **False Positives**: Một số nấm ăn được bị cảnh báo sai (6.4%), có thể giảm bằng cách fine-tune

e) Khuyến nghị cho triển khai thực tế:

1. **Production**: Sử dụng **ResNet-50** cho accuracy cao nhất và an toàn nhất
2. **Mobile/Edge**: Sử dụng **MobileNetV3-Large** cho tốc độ và kích thước nhỏ
3. **Balance**: Sử dụng **EfficientNet-B0** cho sự cân bằng tốt
4. **Monitoring**: Theo dõi performance trên dữ liệu thực tế để phát hiện data drift
5. **Continuous Improvement**: Thu thập thêm dữ liệu cho các lớp có performance thấp (Agaricus, Cortinarius)

f) Kết luận cuối cùng:

Hệ thống nhận diện chi nấm và cảnh báo độc tính đã đạt được các mục tiêu đề ra với performance cao và đảm bảo an toàn. ResNet-50 được khuyến nghị cho production với accuracy 91.59% và poisonous recall 90.5%, đảm bảo vừa chính xác vừa an toàn cho người dùng. Các mô hình khác cũng có performance tốt và phù hợp cho các use case cụ thể. Hệ thống sẵn sàng cho việc triển khai thực tế với các cải thiện liên tục dựa trên dữ liệu thực tế.

